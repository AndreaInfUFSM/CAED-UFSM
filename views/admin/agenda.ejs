<!DOCTYPE html>
<html>
<head>
  <% include partials/head %>
    <!-- Custome CSS -->
  <link href="/css/custom/custom.css" type="text/css" rel="stylesheet">
	<!-- Fullcalendar -->
	<link href="/fullcalendar/fullcalendar.css" type="text/css" rel="stylesheet"/>
	<link href="/fullcalendar/fullcalendar.min.css" type="text/css" rel="stylesheet" />
	<link href="/fullcalendar/fullcalendar.print.min.css" type="text/css" rel="stylesheet" media="print" />
</head>
<body>
  <% include partials/header %>

  <!-- Main -->
  <div id="main">
    <!-- Wrapper -->
    <div class="wrapper">
      <!-- Left Sidebar Nav-->
        <% include partials/aside %>
      <!-- /Left Sidebar Nav-->
      <!-- Content -->
      <section id="content">
 				<!--start container-->
        <div class="container">
          <div class="section">
            <h4 class="center">Agenda de atendimentos</h4>
            <div id="full-calendar">
              <div class="row">
                <div class="col s12 m4 l3">
                  <div id='external-events'>
                    <h4 class="header">Solicitações</h4>
                    <% if ( locals.data ) {
                              for (var row = 1; row < data.length; row++) { %>
                      <div class=''>
                        <a class="fc-event grey waves-effect waves-light modal-trigger" href="#modal<%=row%>">
                          <%= data[row][2] %>
                        </a>
                      </div>
                      <!--VERIFICAR ALGUMAS COISAS PARA COLOCAR COR
                              Se for educação especial -> class = "green"
                              Se for encaminhamento -> class = "amber"
                              Se for Resolução 33 -> class = "blue"
                              tentei fazer if(data[row][6]) e não funcionou
                              -->
                      <% }; %>
                        <% } else { %>
                          <p>Data is empty</p>
                          <% } %>
                            <p>
                              <input type='checkbox' id='drop-remove' />
                              <label for='drop-remove'>remove after drop</label>
                            </p>

                  </div>
                </div>
                <div class="col s12 m8 l9">
                  <div id='calendar' class="calendar"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- /Content-->
    </div>
    <!-- /Wrapper -->
  </div>
  <!-- /Main -->

  <% if ( locals.data ) { %>
  <% for (var row = 1; row < data.length; row++) { %>
    <!-- Modal Structure -->
    <div id="modal<%= row %>" class="modal">
      <div class="modal-content">
        <h4>Horários Livres
          <%= data[row][2] %>
        </h4>
        <div class="col s12">
          <div id='calendar-aluno<%= row %>' class="calendar"></div>
        </div>
      </div>
      <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect waves-green btn-flat">Ok</a>
      </div>
    </div>
  <% }; %>
  <% } %>

  <% include partials/footer %>
  <!--Calendar-->
  <script src='/fullcalendar/lib/jquery-ui.min.js'></script>
  <script src='/fullcalendar/lib/moment.min.js'></script>
  <script src='/fullcalendar/fullcalendar.js'></script>
  <script src="/fullcalendar/locale/pt-br.js"></script>
  <script src="/js/custom-script.js"></script>
  <% if ( locals.data ) { %>
  <script>
    $(function() {
    <% for (var row = 1; row < data.length; row++) { %>
      $('#calendar-aluno<%= row %>').fullCalendar({
        header: {
          left: 'prev,next today',
          center: 'title',
          right: 'agendaWeek,agendaDay,listWeek'
        },
        defaultView: 'agendaWeek',
        navLinks: true, // can click day/week names to navigate views
        editable: true,
        droppable: true,  
        eventLimit: true, // allow "more" link when too many events
        weekends: false,
        allDaySlot: false,
        minTime: '08:00:00',
        maxTime: '20:00:00',
        events: [
          {
            title: '<%= data[row][2] %>',
            start: '2018-10-03T14:00:00',
            end: '2018-10-03T15:00:00',
            constraint: 'fixed',
            color: '#9c27b0'
          },
          {
            id: 'fixed'
          }
        ]
      });
    <% }; %>
    }); 
  </script>
  <% } %>
</html>

 <%# data.forEach(function(row) { %>
      <%# row.forEach(function(col) { %>
        <td>
          <%#= col %>
        </td>
        <%# }); %>
          <%# }); %>